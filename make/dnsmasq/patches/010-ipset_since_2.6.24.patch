--- src/config.h
+++ src/config.h
@@ -135,7 +135,15 @@
 #define HAVE_TFTP
 #define HAVE_SCRIPT
 #define HAVE_AUTH
+#if defined(__linux__)
+#include <linux/version.h>
+// IPSET feature requires the kernel to provide the following headers/symbols:
+//  - nfnetlink.h/nlattr                 available since 2.6.15
+//  - NLA_F_NESTED/NLA_F_NET_BYTEORDER   available since 2.6.24
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24)
 #define HAVE_IPSET 
+#endif
+#endif
 /* #define HAVE_LUASCRIPT */
 /* #define HAVE_BROKEN_RTC */
 /* #define HAVE_DBUS */
